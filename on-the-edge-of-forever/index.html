<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.17.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="de" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Griff in die Geschichte - www.cali.run</title>
<meta name="description" content="        ">


  <meta name="author" content="Cali 7even">


<meta property="og:type" content="article">
<meta property="og:locale" content="de_AT">
<meta property="og:site_name" content="www.cali.run">
<meta property="og:title" content="Griff in die Geschichte">
<meta property="og:url" content="https://cali.run/on-the-edge-of-forever/">


  <meta property="og:description" content="        ">







  <meta property="article:published_time" content="2019-02-27T14:50:14+00:00">



  <meta property="article:modified_time" content="2019-11-23T00:00:00+00:00">



  

  


<link rel="canonical" href="https://cali.run/on-the-edge-of-forever/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Cali 7even",
      "url": "https://cali.run/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="www.cali.run Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->
<!-- insert favicons. use https://realfavicongenerator.net/ -->
<meta name="theme-color" content="#ffffff">
<meta name="msapplication-TileColor" content="#48451d">
<meta name="msapplication-config" content="https://7pub.github.io/favicon/browserconfig.xml">

<link rel="icon" type="image/png" sizes="32x32" href="https://7pub.github.io/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://7pub.github.io/favicon/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://7pub.github.io/favicon/apple-touch-icon.png">

<link rel="manifest" href="https://7pub.github.io/favicon/site.webmanifest">
<link rel="mask-icon" href="https://7pub.github.io/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="https://7pub.github.io/favicon/favicon.ico">

<!-- end custom head snippets -->

  </head>

  <body class="layout--single small">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/88x88.png" alt=""></a>
        
        <a class="site-title" href="/">
          Minimal Mistake
          <span class="site-subtitle">zitronengulasch geht abends</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/tl-tr/" >tL; tR;</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Kategorien</a>
            </li><li class="masthead__menu-item">
              <a href="/sitemap/" >Seitenverzeichniss</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Menü ein-/ausschalten</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/joker.jpg" alt="Cali 7even" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Cali 7even</h3>
    
    
      <div class="author__bio" itemprop="description">
        <table>
  <tbody>
    <tr>
      <td>We Flash - You Don`t</td>
    </tr>
  </tbody>
</table>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">App Menü</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="/app-cassandra/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-crown" aria-hidden="true"></i> App: Cassandra <em>Excava</em></a></li>
          
        
          
            <li><a href="/app-tricon/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-heart-broken" aria-hidden="true"></i> App: Tricon <em>Dedection</em></a></li>
          
        
          
            <li><a href="/app-intelframework/" rel="nofollow noopener noreferrer"><i class="fas fa-project-diagram" aria-hidden="true"></i> App: <em>Intel Framework</em></a></li>
          
        
          
            <li><a href="/app-chefkoch/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-blender" aria-hidden="true"></i> App: Chefkoch <em>Set the table</em></a></li>
          
        
          
            <li><a href="/app-caiwai/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-paste" aria-hidden="true"></i> App: Caiwai <em>Privat</em></a></li>
          
        
          
            <li><a href="/app-whatsspypublic/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-paste" aria-hidden="true"></i> App: WhatsSpy Public</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Griff in die Geschichte">
    <meta itemprop="description" content="        ">
    <meta itemprop="datePublished" content="February 27, 2019">
    <meta itemprop="dateModified" content="November 23, 2019">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Griff in die Geschichte
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  18 Minuten zum lesen

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-heart"></i> Unique Title</h4></header>
              <ul class="toc__menu">
  <li><a href="#">The perfect starting point to integrate Algolia within your JavaScript project</a></li>
</ul>
            </nav>
          </aside>
        
        <p align="center">
  <a href="https://www.algolia.com">
    <img alt="Algolia for JavaScript" src="https://raw.githubusercontent.com/algolia/algoliasearch-client-common/master/banners/javascript.png" />
  </a>

  <h4 align="center">The perfect starting point to integrate <a href="https://algolia.com" target="_blank">Algolia</a> within your JavaScript project</h4>

  <p align="center">
    <a href="https://travis-ci.org/algolia/algoliasearch-client-javascript"><img src="https://img.shields.io/travis/algolia/algoliasearch-client-javascript/master.svg" alt="Build Status" />&lt;/img&gt;</a>
    <a href="https://npmjs.org/package/algoliasearch"><img src="https://img.shields.io/npm/v/algoliasearch.svg?style=flat-square" alt="NPM version" />&lt;/img&gt;</a>
    <a href="http://npm-stat.com/charts.html?package=algoliasearch"><img src="https://img.shields.io/npm/dm/algoliasearch.svg?style=flat-square" alt="NPM downloads" /></a>
    <a href="https://www.jsdelivr.com/package/npm/algoliasearch"><img src="https://data.jsdelivr.com/v1/package/npm/algoliasearch/badge" alt="jsDelivr Downloads" />&lt;/img&gt;</a>
    <a href="LICENSE.txt"><img src="https://img.shields.io/badge/license-MIT-green.svg?style=flat-square" alt="License" /></a>
  </p>
</p>

<p>#!/usr/bin/env bash
######################## Constants and variables ###############################</p>
<h1 id="erwägen-sie-die-installation-um-bessere-ergebnisse-zu-erzielen">Erwägen Sie die Installation, um bessere Ergebnisse zu erzielen</h1>

<p>SCRIPTPATH=”$( cd “$(dirname “$0”)” ; pwd -P )”</p>
<h1 id="colors">Colors</h1>
<p>GREEN=’\033[1;32m’
NC=’\033[0m’ # No Color
RED=’\033[1;31m’
YELLOW=’\033[0;33m’</p>
<h1 id="input-variables">Input variables</h1>
<p>checkall=0
POSITIONAL=()
while [[ $# -gt 0 ]]
do
key=”$1”
case $key in
    -d|–domain)
    domain=”$2”
    shift # past argument
    shift # past value
    ;;
    -o|–outputfile)
    outfile=”$2”
    shift # past argument
    shift # past value
    ;;
    -l|–listsubdomains)
    listsubdomains=”$2”
    shift # past argument
    shift # past value
    ;;
    -a|–checkall)
    checkall=1
    shift # past argument
    ;;
    *)    # unknown option
    POSITIONAL+=(“$1”) # save it in an array for later
    shift # past argument
    ;;
esac
done
set – “${POSITIONAL[@]}” # restore positional parameters</p>

<p>################################################################################
######################## Show Script Information ###############################
################################################################################
if [ -z “$domain” ] ; then
	  echo ‘usage: ./bypass-firewalls-by-DNS-history.sh -d example.com’
    echo ‘-d –domain: domain to bypass’
    echo “-o –outputfile: output file with IP’s only”
    echo ‘-l –listsubdomains: list with subdomains for extra coverage’
    echo ‘-a –checkall: Check all subdomains for a WAF bypass’
    exit 0
fi
################################################################################
######################## Various ###############################################
################################################################################</p>

<h1 id="check-if-jq-is-installed">Check if jq is installed</h1>
<p>jq –help &gt;/dev/null 2&gt;&amp;1 || { echo &gt;&amp;2 “‘jq’ wird für zusätzliche Subdomain-Lookups benötigt, ist aber nicht installiert Wird für zusätzliche Subdomain-Lookups benötigt, ist aber nicht installiert.  (eg.: ‘apt install jq’). Aborting.”; exit 1; }</p>

<h1 id="cleanup-temp-files-when-program-was-interrupted">Cleanup temp files when program was interrupted.</h1>
<p>rm /tmp/waf-bypass-<em>$domain</em> &amp;&gt; /dev/null</p>

<h1 id="add-extra-subdomains">Add extra Subdomains</h1>
<p>if [ -n “$listsubdomains” ] ; then
  cat $listsubdomains &gt; /tmp/waf-bypass-alldomains-$domain.txt
fi</p>

<p>################################################################################
######################## Show Logo  ############################################
################################################################################</p>

<h2 id="cat-eof">cat « “EOF”</h2>
<hr />
<p>\ \        / /\   |  <strong>__| | |
  \ \  /\  / /  \  | |</strong>    | |__  _   _ _ __   __ _ <strong>_ ___
   \ \/  \/ / /\ \ |  __|   | ‘_ | | | | ‘_ \ / <em>` / __/ __|
    \  /\  / ____ | |      | |</em>) | |<em>| | |</em>) | (<em>| _</em> __ <br />
     \/  \/<em>/    __|      |</em>.</strong>/ _<em>, | .<strong>/ __,_|</strong></em>/<strong><em>/
                                    __/ | |
                                   |</em></strong>/|_|
Via DNS history. ( @vincentcox_be | vincentcox.com )
————————————————————-
EOF</p>

<p>################################################################################
######################## Matchmaking function ##################################
################################################################################</p>
<h1 id="purpose-sometimes-old-ips-become-different-peoples-server-for-example-a">Purpose: Sometimes old IP’s become different people’s server. For example a</h1>
<h1 id="company-uses-a-digitalocean-vps-and-after-one-year-they-switched-to-amazon">company uses a Digitalocean VPS and after one year they switched to amazon</h1>
<h1 id="so-they-remove-their-vps-instance-the-ip-is-then-released-and-then-used-by">so they remove their VPS instance. The IP is then released and then used by</h1>
<h1 id="some-dudes-server-for-a-hobby-project-to-verify-if-we-got-a-hit-we-need">some dude’s server for a hobby project. To verify if we got a hit, we need</h1>
<h1 id="to-inspect-the-html-and-compare-it-from-the-waf-and-the-direct-ip-and-calculate">to inspect the HTML and compare it from the WAF and the direct IP and Calculate</h1>
<h1 id="a-match-percentage-this-is-exactly-what-we-are-going-to-do-here">a match percentage. This is exactly what we are going to do here.</h1>
<h1 id="this-script-is-called-later-on-in-the-script">This script is called later on in the script.</h1>

<h2 id="most-sites-redirect-http-to-https-so-the-response-body-of-http-will-be-empty-causing-false-positives-to-appear">Most sites redirect HTTP to HTTPS, so the response body of http will be empty, causing false positives to appear.</h2>
<p>{
if (curl –silent -v http://$domain 2&gt;&amp;1|tr ‘\n’ ‘ ‘| grep -e “Moved Permanently.*https://$domain”); then
  cp “/tmp/waf-bypass-https-$domain” “/tmp/waf-bypass-http-$domain”
fi
} &amp;&gt; /dev/null # hide verbose output curl, somehow –silent is not enough when verbose is on.</p>

<h2 id="this-function-is-called-to-do-the-actual-comparing">This function is called to do the actual comparing</h2>
<p>function matchmaking {
file1=$1
file2=$2
ip=$3
matchmaking=$4
domain=$5
protocol=$6</p>
<h2 id="get-the-original-content-of-the-website-to-compare-this-to-during-the-matchmaking">Get the original content of the website to compare this to during the matchmaking</h2>
<p>curl –silent -o “/tmp/waf-bypass-https-$domain” “https://$domain”
curl –silent -o “/tmp/waf-bypass-http-$domain” “http://$domain”
touch $file1
touch $file2
thread=$!
sizefile1=$(cat $file1 | wc -l )
sizefile2=$(cat $file2 | wc -l )
biggestsize=$(( $sizefile1 &gt; $sizefile2 ? $sizefile1 : $sizefile2 ))
if [[ $biggestsize -ne 0  ]]; then
  difference=$(( $(sdiff -B -b -s $file1 $file2 | wc -l) ))
  confidence_percentage=$(( 100 * (( $biggestsize - ${difference#-} )) / $biggestsize ))
  if [[ $confidence_percentage -gt 0 ]]; then
    echo “$ip” » “$outfile”
    if [[ $checkall -le 0 ]];then
      echo -e “$protocol://$ip | $confidence_percentage % | $(curl –silent https://ipinfo.io/$ip/org )” »  /tmp/waf-bypass-output-$domain.txt
    else
      echo -e “$protocol://$domain | $ip | $confidence_percentage % | $(curl –silent https://ipinfo.io/$ip/org )” »  /tmp/waf-bypass-output-$domain.txt
    fi
  fi</p>

<p># —- Debugging Info —-
  echo “$file1 $file2” » /tmp/waf-bypass-thread-$thread.txt
  echo “#Lines $file1: $sizefile1” » /tmp/waf-bypass-thread-$thread.txt
  echo “#Lines $file2: $sizefile2” » /tmp/waf-bypass-thread-$thread.txt
  echo “Different lines: $difference” » /tmp/waf-bypass-thread-$thread.txt
  echo -e “$ip | $confidence_percentage %” » /tmp/waf-bypass-thread-$thread.txt
  echo “—-“ » /tmp/waf-bypass-thread-$thread.txt
  # if [ “$confidence_percentage” -gt 0 ]; then
  # cat /tmp/waf-bypass-thread-$thread.txt
  # fi</p>

<p># Uncomment the following line to output the debugging info.
  # cat /tmp/waf-bypass-thread-$thread.txt
  # ++++ Debugging Info ++++
fi
}</p>

<p>################################################################################
######################## IP Validation #########################################
################################################################################</p>
<h1 id="purpose-we-need-to-check-if-the-ip-we-find-is-not-just-the-current-ip-and-not">Purpose: we need to check if the IP we find is not just the current IP and not</h1>
<h1 id="a-public-waf-service">a public WAF service.</h1>

<h1 id="if-no-output-file-is-specified">If no output file is specified</h1>
<p>if [ -z “$outfile” ]; then
  outfile=/tmp/waf-bypass-log.txt # Get’s removed anyway at the end of script.
	if [ -f “$outfile” ]; then
	  rm “$outfile”
	fi
fi</p>

<h1 id="exclude-public-known-waf-ips">Exclude Public Known WAF IP’s</h1>
<p>PUBLICWAFS=’103.21.244.0/22 103.22.200.0/22 103.31.4.0/22 104.16.0.0/12 108.162.192.0/18 131.0.72.0/22 141.101.64.0/18 162.158.0.0/15 172.64.0.0/13 173.245.48.0/20 188.114.96.0/20 190.93.240.0/20 197.234.240.0/22 198.41.128.0/17 199.83.128.0/21 198.143.32.0/19 149.126.72.0/21 103.28.248.0/22 45.64.64.0/22 185.11.124.0/22 192.230.64.0/18 107.154.0.0/16 45.60.0.0/16 45.223.0.0/16’
function in_subnet {
    # Determine whether IP address is in the specified subnet.
    #
    # Args:
    #   sub: Subnet, in CIDR notation.
    #   ip: IP address to check.
    #
    # Returns:
    #   1|0
    #
    local ip ip_a mask netmask sub sub_ip rval start end</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Define bitmask.
local readonly BITMASK=0xFFFFFFFF

# Read arguments.
IFS=/ read sub mask &lt;&lt;&lt; "${1}"
IFS=. read -a sub_ip &lt;&lt;&lt; "${sub}"
IFS=. read -a ip_a &lt;&lt;&lt; "${2}"

# Calculate netmask.
netmask=$(($BITMASK&lt;&lt;$((32-$mask)) &amp; $BITMASK))

# Determine address range.
start=0
for o in "${sub_ip[@]}"
do
    start=$(($start&lt;&lt;8 | $o))
done

start=$(($start &amp; $netmask))
end=$(($start | ~$netmask &amp; $BITMASK))

# Convert IP address to 32-bit number.
ip=0
for o in "${ip_a[@]}"
do
    ip=$(($ip&lt;&lt;8 | $o))
done

# Determine if IP in range.
(( $ip &gt;= $start )) &amp;&amp; (( $ip &lt;= $end )) &amp;&amp; rval=1 || rval=0
echo "${rval}" }
</code></pre></div></div>

<p>function ip_is_waf {
IP=$1
for subnet in $PUBLICWAFS
do
    (( $(in_subnet $subnet $IP) )) &amp;&amp;
        echo 1 &amp;&amp; break
done
}</p>

<p>################################################################################
######################## Subdomain Gathering  ##################################
################################################################################</p>
<h1 id="purpose-subdomains-can-point-to-origin-ips-behind-the-firewall-waf">Purpose: Subdomains can point to origin IP’s behind the firewall (WAF).</h1>

<h1 id="function-to-get-subdomains-from-dnsdumpster">Function to get subdomains from DNSDumpster</h1>
<p>function dnsdumpster_subdomains {
domain=$1
curl https://dnsdumpster.com -o /dev/null -c /tmp/dnsdumpster-$domain-cookies.txt -s
CSRF=”$(grep csrftoken /tmp/dnsdumpster-$domain-cookies.txt | cut -f 7)”
curl -s -X ‘POST’ -H ‘Host: dnsdumpster.com’ -H ‘Pragma: no-cache’ -H ‘Cache-Control: no-cache’ -H ‘Upgrade-Insecure-Requests: 1’ -H ‘User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36’ -H ‘Origin: https://dnsdumpster.com’ -H ‘Content-Type: application/x-www-form-urlencoded’ -H ‘Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,<em>/</em>;q=0.8’ -H ‘Referer: https://dnsdumpster.com/’ -H ‘Accept-Language: en-US,en;q=0.9,nl;q=0.8’ -H “Cookie: csrftoken=$CSRF” -b “csrftoken=$CSRF” –data-binary “csrfmiddlewaretoken=$CSRF&amp;targetip=$domain” -o /tmp/dnsdumpster-$domain-output.txt ‘https://dnsdumpster.com/’
regex=’\w*.‘$domain
cat /tmp/dnsdumpster-$domain-output.txt | grep -oh “$regex” | sort -u
rm /tmp/dnsdumpster-$domain-output.txt
rm /tmp/dnsdumpster-$domain-cookies.txt
}</p>

<h1 id="dnsdumpster-call-function">DNSDumpster (call function)</h1>
<p>echo “$(dnsdumpster_subdomains $domain)” » /tmp/waf-bypass-alldomains-$domain.txt</p>
<h1 id="certspotter">Certspotter</h1>
<p>curl -s https://certspotter.com/api/v0/certs?domain=$domain | jq -c ‘.[].dns_names’ | grep -o ‘”[^”]+”’ | grep “$domain” | sed ‘s/”//g’ » /tmp/waf-bypass-alldomains-$domain.txt</p>
<h1 id="virustotal">Virustotal</h1>
<p>curl -s https://www.virustotal.com/ui/domains/$domain/subdomains\?limit= | jq .data[].id | grep -o ‘”[^”]+”’ | grep “$domain” | sed ‘s/”//g’ » /tmp/waf-bypass-alldomains-$domain.txt</p>
<h1 id="add-own-domain">Add own domain</h1>
<p>echo “$domain” » /tmp/waf-bypass-alldomains-$domain.txt</p>
<h1 id="filter-unique-ones--remove-wildcards">Filter unique ones + remove wildcards</h1>
<p>cat  /tmp/waf-bypass-alldomains-$domain.txt | sort -u | grep -v -E ‘*’ &gt;  /tmp/waf-bypass-domains-filtered.txt</p>
<h1 id="read-file-to-array-readarray-doesnt-work-on-os-x-so-we-use-the-traditional-way">Read file to array. Readarray doesn’t work on OS X, so we use the traditional way.</h1>
<p>while IFS== read var; do
    domainlist+=($var)
done &lt; /tmp/waf-bypass-domains-filtered.txt</p>

<h1 id="--debugging-info--">—- Debugging Info —-</h1>
<h1 id="echo-using-the-ips-of-the-following-subdomains-for-max-coverage">echo “Using the IP’s of the following (sub)domains for max coverage:”</h1>
<h1 id="echo-echo-domainlist">echo $(echo ${domainlist[*]})</h1>
<h1 id="-debugging-info-">++++ Debugging Info ++++</h1>

<p>echo -e “${YELLOW}[-] $(echo ${#domainlist[@]}) Domains collected…${NC}”</p>

<p>################################################################################
######################## Get IP’s from subdomains  #############################
################################################################################</p>

<p>progresscounter=0
for domainitem in “${domainlist[@]}”
do
   progresscounter=$(($progresscounter+1))
   echo -ne “${YELLOW}[-] Scraping IP’s from (sub)domains ($((100<em>$progresscounter/${#domainlist[@]}))%)${NC}\r”
   domainitem=$( echo $domainitem | tr -d ‘\n’)
   ### Source: viewdns.info
   list_ips=$list_ips” “$( curl –max-time 10 -s -H ‘user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36’ -H ‘content-type: application/json;charset=UTF-8’ -H ‘accept: application/json, text/plain, */</em>’ https://viewdns.info/iphistory/?domain=$domainitem | grep -o ‘[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}’ | sort -u)
   ### Source: SecurityTrials
   list_ips=$list_ips” “$( curl –max-time 10 -s “https://securitytrails.com/domain/$domainitem/history/a” | grep -o ‘[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}’ )
   ### Source: Security Trials API (alternative)
   list_ips=$list_ips” “$(curl -s “https://securitytrails.com/app/api/v1/history/$domainitem/dns/a?page=0” -H ‘pragma: no-cache’ -H ‘origin: https://securitytrails.com’ -H ‘accept-encoding: gzip, deflate, br’ -H ‘accept-language: en-US,en;q=0.9,nl;q=0.8’ -H ‘user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36’ -H ‘content-type: application/json;charset=UTF-8’ -H ‘accept: application/json, text/plain, <em>/</em>’ -H ‘cache-control: no-cache’ -H ‘authority: securitytrails.com’ -H “referer: https://securitytrails.com/domain/$domainitem/history/a” –data-binary ‘{“captcha”:null,”_csrf_token”:””}’ –compressed | grep -o ‘[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}’)
   ### Source: http://crimeflare.com/
   list_ips=$list_ips” “$( curl –max-time 15 -s ‘http://www.crimeflare.com:82/cgi-bin/cfsearch.cgi’ -H ‘Connection: keep-alive’ -H ‘Pragma: no-cache’ -H ‘Cache-Control: no-cache’ -H ‘Origin: http://www.crimeflare.com:82’ -H ‘Upgrade-Insecure-Requests: 1’ -H ‘DNT: 1’ -H ‘Content-Type: application/x-www-form-urlencoded’ -H ‘User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.67 Safari/537.36’ -H ‘Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,<em>/</em>;q=0.8’ -H ‘Referer: http://www.crimeflare.com:82/cfs.html’ -H ‘Accept-Encoding: gzip, deflate’ -H ‘Accept-Language: en-US,en;q=0.9,nl;q=0.8’ –data “cfS=$domainitem” –compressed  | grep -o ‘[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}’ )
done
echo “” # Fix new line issue
list_ips=$(echo $list_ips | tr “ “ “\n” | sort -u )
echo -e “${YELLOW}[-] $( echo $list_ips | tr “ “ “\n” | wc -l | tr -d ‘[:space:]’) IP’s gathered from DNS history…${NC}”</p>
<h1 id="--debugging-info---1">—- Debugging Info —-</h1>
<h1 id="echo--e-yellow-ips-echo-list_ips-nc">echo -e “${YELLOW}[!] IP’s: $(echo ${list_ips[*]}) ${NC}”</h1>
<h1 id="-debugging-info--1">++++ Debugging Info ++++</h1>
<p>################################################################################
######################## Bypass Test ###########################################
################################################################################</p>
<h1 id="for-each-ip-test-the-bypass-and-calculate-the-match-">For each IP test the bypass and calculate the match %</h1>
<p>echo -e “${YELLOW}[-] Launching requests to origin servers…${NC}”
if [[ $checkall -eq 0 ]];then
  for ip in $list_ips;do
    if [[ $(ip_is_waf $ip) -eq 0 ]];then
      # Remove current IP’s via nslookup
      currentips=$(nslookup $domain | grep -o ‘[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}’)
      protocol=”https”
      (if (curl –fail –max-time 10 –silent -k “$protocol://$domain” –resolve “$domain:443:$ip” | grep “html” | grep -q -v “was rejected” );then if [[ $currentips != <em>“$ip”</em> ]];then curl –silent -o “/tmp/waf-bypass-$protocol-$ip-$domain” -k -H “Host: $domain” “$protocol”://”$ip”/ ; matchmaking “/tmp/waf-bypass-$protocol-$domain” “/tmp/waf-bypass-$protocol-$ip-$domain” “$ip” “$checkall” “$domain” “$protocol”;wait; fi; fi) &amp; pid=$!;
      PID_LIST+=” $pid”;
      protocol=”http”
      (if (curl –fail –max-time 10 –silent -k “$protocol://$domain” –resolve “$domain:80:$ip” | grep “html” | grep -q -v “was rejected” );then if [[ $currentips != <em>“$ip”</em> ]];then curl –silent -o “/tmp/waf-bypass-$protocol-$ip-$domain” -k -H “Host: $domain” “$protocol”://”$ip”/ ; matchmaking “/tmp/waf-bypass-$protocol-$domain” “/tmp/waf-bypass-$protocol-$ip-$domain” “$ip” “$checkall” “$domain” “$protocol”;wait; fi; fi) &amp; pid=$!;
      PID_LIST+=” $pid”;
    fi
  done
else
for domainitem in “${domainlist[@]}”;do
  tempstorage=$domain
  domain=$domainitem
  for ip in $list_ips;do
    if [[ $(ip_is_waf $ip) -eq 0 ]];then
      # Remove current IP’s via nslookup
      currentips=$(nslookup $domain | grep -o ‘[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}’)
      protocol=”https”
      (if (curl –fail –max-time 10 –silent -k “$protocol://$domain” –resolve “$domain:443:$ip” | grep “html” | grep -q -v “was rejected” );then if [[ $currentips != <em>“$ip”</em> ]];then curl –silent -o “/tmp/waf-bypass-$protocol-$ip-$domain” -k -H “Host: $domain” “$protocol”://”$ip”/ ; matchmaking “/tmp/waf-bypass-$protocol-$domain” “/tmp/waf-bypass-$protocol-$ip-$domain” “$ip” “$checkall” “$domain” “$protocol”;wait; fi; fi) &amp; pid=$!;
      PID_LIST+=” $pid”;
      protocol=”http”
      (if (curl –fail –max-time 10 –silent -k “$protocol://$domain” –resolve “$domain:80:$ip” | grep “html” | grep -q -v “was rejected” );then if [[ $currentips != <em>“$ip”</em> ]];then curl –silent -o “/tmp/waf-bypass-$protocol-$ip-$domain” -k -H “Host: $domain” “$protocol”://”$ip”/ ; matchmaking “/tmp/waf-bypass-$protocol-$domain” “/tmp/waf-bypass-$protocol-$ip-$domain” “$ip” “$checkall” “$domain” “$protocol”;wait; fi; fi) &amp; pid=$!;
      PID_LIST+=” $pid”;
    fi
  done
  domain=$tempstorage
done
fi
echo -e “${YELLOW}[-] Waiting on replies from origin servers…${NC}”
trap “kill $PID_LIST” SIGINT
wait $PID_LIST
if [ ! -f “$outfile” ]; then
  echo -e “${RED}[-] No Bypass found!${NC}”
else
  echo -e “${GREEN}[+] Bypass found!${NC}”
	sort -u -o “$outfile” “$outfile”
  if [[ $checkall -eq 0 ]];then
    echo -e “[IP] | [Confidence] | [Organisation]” »  /tmp/waf-bypass-output-$domain-2.txt
  else
    echo -e “[Domain] | [IP] | [Confidence] | [Organisation]” »  /tmp/waf-bypass-output-$domain-2.txt
  fi
  cat /tmp/waf-bypass-output-$domain.txt | sort -ur » /tmp/waf-bypass-output-$domain-2.txt
  cat /tmp/waf-bypass-output-$domain-2.txt &gt; /tmp/waf-bypass-output-$domain.txt
fi</p>

<p>################################################################################
######################## Presenting output + cleanup ###########################
################################################################################</p>

<h1 id="when-checkall-is-enabled-merge-all-results-to-main-file">When checkall is enabled, merge all results to main file</h1>
<p>for domainitem in “${domainlist[@]}”
do
  if [ “$domainitem” != “$domain” ];then
    touch “/tmp/waf-bypass-output-$domainitem.txt”
    cat “/tmp/waf-bypass-output-$domainitem.txt” » “/tmp/waf-bypass-output-$domain.txt”
  fi
done</p>

<p>touch /tmp/waf-bypass-output-$domain.txt # If no IP’s were found, the script will be empty.
cat “/tmp/waf-bypass-output-$domain.txt” | column -s”|” -t</p>

<h1 id="cleanup-temp-files">Cleanup temp files</h1>
<p>rm /tmp/waf-bypass-<em>$domain</em></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#update" class="page__taxonomy-item" rel="tag">update</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Kategorien: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#xkcd" class="page__taxonomy-item" rel="tag">XKCD</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Aktualisiert:</strong> <time datetime="2019-11-23">November 23, 2019</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Teilen auf</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Griff+in+die+Geschichte%20https%3A%2F%2Fcali.run%2Fon-the-edge-of-forever%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Teilen auf Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcali.run%2Fon-the-edge-of-forever%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Teilen auf Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fcali.run%2Fon-the-edge-of-forever%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Teilen auf LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="#" class="pagination--pager disabled">Vorherige</a>
    
    
      <a href="/vulnerabilities-analysis/" class="pagination--pager" title="Schwachstellenanalysen
">Nächste</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">Ihnen gefällt vielleicht auch</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/500x300.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/wipro-defendant/" rel="permalink">Wipro verursacht 140 Milionen Schaden
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  115 Minuten zum lesen

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Ich habe euch die original Anklageschrift angehägt. Persönlich muss ich wirklich gestehen das ich direkt ein wenig Schadenfroh bin.


</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/500x300.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/how-hacking-works/" rel="permalink">Wie hacken funktioniert
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  4 Minuten zum lesen

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Der Begriff Hacken kommt aus dem deutschen Sprachgebrauch. Überrascht..?
Es bedeuted - zerteilen -  oder  - etwas in Stücke schneiden - 
und beschreibt den V...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/500x300.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/the-pyramide-of-pain/" rel="permalink">Die Pyramide des Schmerzes
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 Minuten zum lesen

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Wer kennt das Gefühl, etwas Beichten zu müssen und wieder einen Tag vorbei ziehen zu lassen? Termine Morgen: „heute grosse Feier“
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/500x300.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/jedem-hacker-sein-hut/" rel="permalink">Jedem Hacker sein Hut
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  4 Minuten zum lesen

</p>
    
    <p class="archive__item-excerpt" itemprop="description"> Nicht alle Hacker sind gleich:
Es gibt eine Reihe von Hackertypen. Hier sind einige der gebräuchlichsten Begriffe, mit denen Hacker beschrieben werden und w...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>App Menü:</strong></li>
    

    
      
        
          <li><a href="/app-cassandra/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-crown" aria-hidden="true"></i> App: Cassandra <em>Excava</em></a></li>
        
      
        
          <li><a href="/app-tricon/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-heart-broken" aria-hidden="true"></i> App: Tricon <em>Dedection</em></a></li>
        
      
        
          <li><a href="/app-intelframework/" rel="nofollow noopener noreferrer"><i class="fas fa-project-diagram" aria-hidden="true"></i> App: <em>Intel Framework</em></a></li>
        
      
        
          <li><a href="/app-chefkoch/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-blender" aria-hidden="true"></i> App: Chefkoch <em>Set the table</em></a></li>
        
      
        
          <li><a href="/app-caiwai/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-paste" aria-hidden="true"></i> App: Caiwai <em>Privat</em></a></li>
        
      
        
          <li><a href="/app-whatsspypublic/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-paste" aria-hidden="true"></i> App: WhatsSpy Public</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Cali 7even. Möglich durch <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
